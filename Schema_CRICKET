use role sysadmin;

use warehouse compute_wh; 

create database if not exists cricket;
create or replace schema cricket.land;
create or replace schema cricket.raw;
create or replace schema cricket.clean;
create or replace schema cricket.consumption;

use schema cricket.land;

show tables;
GRANT OWNERSHIP ON DATABASE cricket TO ROLE sysadmin;
GRANT OWNERSHIP ON SCHEMA cricket.land TO ROLE sysadmin;

show schemas in database cricket;
-- JSON FILE 
CREATE OR REPLACE FILE FORMAT land.my_json_format
    TYPE = json
    NULL_IF = ('\\n', 'null', '')
    STRIP_OUTER_ARRAY = true
    COMMENT = 'Json File Format with outer strip array flag true';

-- creating an internal stage
create or replace stage cricket.land.my_stg;

--let list  the internal stage
list @cricket.land.my_stg;

select
    t.$1:meta::variant as meta,
    t.$1:info::variant as info,
    t.$1:innings::array as innings,
    metadata$filename as file_name,
    metadata$file_row_number int,
    metadata$file_content_key text,
    metadata$file_last_modified stg_modified_ts
from @my_stg/1384401.json (file_format => 'my_json_format') t;

create table t1 (
id int primary key,
name varchar(20)
);

select * from t1;

use database practice;

create database practice;

create table prac (
id int primary key,
name varchar(20)
);

select * from prac;

insert into prac values (2, 'efg');



